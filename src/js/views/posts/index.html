<!DOCTYPE html>

<div class="section">
  <div class="columns is-multiline">
    <div ng-repeat="post in postsIndex.all" class="column is-half is-offset-one-quarter box">
      <h2>"{{ post.description }}"</h2>
      <img ng-src="{{ post.image }}">
      <h2>{{ post.headline }}</h2>
      <h3>{{ post.src }}</h3>
      <h2>{{ post.user.username }}</h2>

      <div ng-repeat="comment in postsIndex.comments" class="column is-half">
        <div ng-if="post.id === comment.post.id">
          <p>"{{ comment.body }}"</p>
          <h5>{{ comment.user.username }}</h5>
          <button ng-click="postsIndex.deleteComment(comment)" ng-if="main.isAuthenticated() && main.currentUser.id === comment.user_id" class="button is-small is-danger">Delete</button>
        </div>
      </div>

      <div ng-if="main.isAuthenticated()">
        <form ng-submit="postsIndex.add()">
          <textarea type="text" name="body" ng-model="postsIndex.comment.body" class="comment"></textarea>
          <button class="button is-small is-primary">Add Comment</button>
        </form>
      </div>

      <button class="button is-small is-danger" ng-click="postsIndex.delete(post)" ng-if="main.isAuthenticated() && main.currentUser.id === post.user.id">Delete</button>
    </div>
  </div>
</div>
